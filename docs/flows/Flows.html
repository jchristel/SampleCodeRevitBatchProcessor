<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Flows package &#8212; Sample Code Revit Batch Processor 0.0.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/adctheme.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <meta name="generator" content="Sphinx/ADC Theme by Mirounga www.mirounga.fr"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Sample Code Revit Batch Processor 0.0.7 documentation" href="../index.html" />
    <link media="only screen and (max-device-width: 480px)" href="../_static/css/mobile.css" type="text/css" rel="stylesheet" /> 
  </head><body>
<div id="docstitle">
    <p>Sample Code Revit Batch Processor 0.0.7 documentation</p>
</div>
<div id="header">
    <div id="title"><h1>Flows package</h1></div>
    <ul id="headerButtons">
        <li id="toc_button"><div class="headerButton"><a href="#">Table of Contents</a></div></li>
        <li id="page_buttons">
            <div class="headerButton"><a href="../genindex.html" title="General Index" accesskey="I">index</a></div>
            <div class="headerButton"><a href="../py-modindex.html" title="Python Module Index" >modules</a></div>
        </li>
    </ul>
</div>

<div id="sphinxsidebar">
  <div class="sphinxsidebarwrapper">
        <ul><li class="toctree-l1"><a href="../index.html">Main Page</a></li></ul>
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../duHast/modules.html">duHast</a></li>
</ul>

      <h3>This Page</h3>
      <ul class="this-page-menu">
        <li><a href="../_sources/flows/Flows.rst.txt"
               rel="nofollow">Show Source</a></li>
      </ul>
    <div id="searchbox" style="display: none">
        <form class="search" action="../search.html" method="get">
                        <div class="search-wrapper">
                        <input type="submit" value="" class="search-left"/>
                        <input class="prettysearch" type="text" name="q" size="18" title="Enter search terms or a module, class or function name."/>
                        <span class="search-right">&nbsp;</span>
                        </div>
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>
  </div>
</div>



    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <section id="flows-package">
<h1>Flows package<a class="headerlink" href="#flows-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-Flows.ModifyAddSharedParas">
<span id="flows-modifyaddsharedparas-module"></span><h2>Flows.ModifyAddSharedParas module<a class="headerlink" href="#module-Flows.ModifyAddSharedParas" title="Permalink to this heading">¶</a></h2>
<section id="add-shared-parameters-to-project-files">
<h3>Add shared parameters to project files.<a class="headerlink" href="#add-shared-parameters-to-project-files" title="Permalink to this heading">¶</a></h3>
<p>This flow demonstrates how to add any number of shared parameters to workshared Revit project files.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="Flows.ModifyAddSharedParas.output">
<span class="sig-name descname"><span class="pre">output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Flows.ModifyAddSharedParas.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Output messages either to batch processor (debug = False) or console (debug = True)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> (<em>str</em><em>, </em><em>optional</em>) – the message, defaults to ‘’</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Flows.ModifyAddSharedParas.update_parameters">
<span class="sig-name descname"><span class="pre">update_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Flows.ModifyAddSharedParas.update_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Bind parameters to category</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc</strong> (<em>Autodesk.Revit.DB.Document</em>) – Current model document</p></li>
<li><p><strong>data</strong> (<em>[</em><em>[</em><em>str</em><em>, </em><em>str</em><em>, </em><em>ParameterType</em><em>, </em><em>bool</em><em>,</em><em>[</em><em>BuiltInCategory</em><em>]</em><em>,</em><em>BuiltInParameterGroup</em><em>, </em><em>bool</em><em>]</em><em>,</em><em>...</em><em>]</em>) – List describing shared parameter to be added. Refer to <cite>listOfParameters_</cite> below</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Result class instance.</p>
<ul class="simple">
<li><p>result.status: Parameters binding status returned in result.status. False if an exception occurred or a parameter bind failed, otherwise True.</p></li>
<li><p>result.message will contain the names of the shared parameters added.</p></li>
<li><p>result.result will be an empty list</p></li>
</ul>
<p>On exception</p>
<ul class="simple">
<li><p>Reload.status (bool) will be False</p></li>
<li><p>Reload.message will contain the exception message</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../duHast/duHast.Utilities.Objects.html#duHast.Utilities.Objects.result.Result" title="duHast.Utilities.Objects.result.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="Flows.ModifyAddSharedParas.SHARED_PARAMETER_FILE_PATH">
<span class="sig-name descname"><span class="pre">SHARED_PARAMETER_FILE_PATH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'C:\\temp\\Shared</span> <span class="pre">Parameters.txt'</span></em><a class="headerlink" href="#Flows.ModifyAddSharedParas.SHARED_PARAMETER_FILE_PATH" title="Permalink to this definition">¶</a></dt>
<dd><p>Fully qualified path to shared parameter file</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="Flows.ModifyAddSharedParas.LIST_OF_PARAMETERS">
<span class="sig-name descname"><span class="pre">LIST_OF_PARAMETERS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[['ParameterOne',</span> <span class="pre">'Exported</span> <span class="pre">Parameters',</span> <span class="pre">Autodesk.Revit.DB.ParameterType.Length,</span> <span class="pre">True,</span> <span class="pre">[Autodesk.Revit.DB.BuiltInCategory.OST_Ceilings],</span> <span class="pre">Autodesk.Revit.DB.BuiltInParameterGroup.PG_GEOMETRY,</span> <span class="pre">True],</span> <span class="pre">['ParameterTwo',</span> <span class="pre">'Exported</span> <span class="pre">Parameters',</span> <span class="pre">Autodesk.Revit.DB.ParameterType.YesNo,</span> <span class="pre">True,</span> <span class="pre">[Autodesk.Revit.DB.BuiltInCategory.OST_Windows,</span> <span class="pre">Autodesk.Revit.DB.BuiltInCategory.OST_CurtainWallPanels,</span> <span class="pre">Autodesk.Revit.DB.BuiltInCategory.OST_Walls],</span> <span class="pre">Autodesk.Revit.DB.BuiltInParameterGroup.PG_IDENTITY_DATA,</span> <span class="pre">True],</span> <span class="pre">['ParameterThree',</span> <span class="pre">'Exported</span> <span class="pre">Parameters',</span> <span class="pre">Autodesk.Revit.DB.ParameterType.Text,</span> <span class="pre">True,</span> <span class="pre">[Autodesk.Revit.DB.BuiltInCategory.OST_Rooms],</span> <span class="pre">Autodesk.Revit.DB.BuiltInParameterGroup.PG_IDENTITY_DATA,</span> <span class="pre">True]]</span></em><a class="headerlink" href="#Flows.ModifyAddSharedParas.LIST_OF_PARAMETERS" title="Permalink to this definition">¶</a></dt>
<dd><p>List containing the parameters to be added and their properties</p>
<blockquote>
<div><ul class="simple">
<li><p>Parameter Name,</p></li>
<li><p>parameter group name ( in shared parameter file),</p></li>
<li><p>the parameter storage type as rdb.ParameterType</p></li>
<li><p>a list of all categories as rdb.BuiltInCategory the parameter is to be added to</p></li>
<li><p>the property group the parameter is to be added to as rdb.BuiltInParameterGroup</p></li>
<li><p>True if parameter is an instance parameter, False if it is a type parameter</p></li>
</ul>
</div></blockquote>
</dd></dl>

</section>
<section id="flows-modifydeletesheetsandviews-module">
<h2>Flows.ModifyDeleteSheetsAndViews module<a class="headerlink" href="#flows-modifydeletesheetsandviews-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifyexportnwc-ifc-module">
<h2>Flows.ModifyExportNWC_IFC module<a class="headerlink" href="#flows-modifyexportnwc-ifc-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifylevelgridscopeboxworsket-module">
<h2>Flows.ModifyLevelGridScopeboxWorsket module<a class="headerlink" href="#flows-modifylevelgridscopeboxworsket-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifymodelmilestone-module">
<h2>Flows.ModifyModelMilestone module<a class="headerlink" href="#flows-modifymodelmilestone-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifymodelreloadlinks-module">
<h2>Flows.ModifyModelReloadLinks module<a class="headerlink" href="#flows-modifymodelreloadlinks-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifyrenameloaded-module">
<h2>Flows.ModifyRenameLoaded module<a class="headerlink" href="#flows-modifyrenameloaded-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifyrevisionandapplytosheets-module">
<h2>Flows.ModifyRevisionAndApplyToSheets module<a class="headerlink" href="#flows-modifyrevisionandapplytosheets-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifyrevisionsimple-module">
<h2>Flows.ModifyRevisionSimple module<a class="headerlink" href="#flows-modifyrevisionsimple-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifyrevitfilesaveas-module">
<h2>Flows.ModifyRevitFileSaveAs module<a class="headerlink" href="#flows-modifyrevitfilesaveas-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifyrevitlinksworksetbylist-module">
<h2>Flows.ModifyRevitLinksWorksetByList module<a class="headerlink" href="#flows-modifyrevitlinksworksetbylist-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifyrevitlinksworksetinstancetotype-module">
<h2>Flows.ModifyRevitLinksWorksetInstanceToType module<a class="headerlink" href="#flows-modifyrevitlinksworksetinstancetotype-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-modifyrevitlinksworksettypetoinstance-module">
<h2>Flows.ModifyRevitLinksWorksetTypeToInstance module<a class="headerlink" href="#flows-modifyrevitlinksworksettypetoinstance-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-Flows.Post_AutoFiling">
<span id="flows-post-autofiling-module"></span><h2>Flows.Post_AutoFiling module<a class="headerlink" href="#module-Flows.Post_AutoFiling" title="Permalink to this heading">¶</a></h2>
<section id="automated-filing">
<h3>Automated filing.<a class="headerlink" href="#automated-filing" title="Permalink to this heading">¶</a></h3>
<p>This flow demonstrates how to file incoming models into as given folder structure and keep a record of date and revision of files received.</p>
<p>The given folder structure includes a NavisWorks federated model folder where all .nwc files are stored. In order to replace existing files in that location, incoming files are stripped of their revision information contained within the file name.</p>
<p>This script can be used when:</p>
<ul>
<li><p>multiple sessions of Revit Batch Processor are to be run in parallel using a batch script set up</p></li>
<li><p>single session of Revit Batch Processor is used</p></li>
<li><p>this can either be:</p>
<blockquote>
<div><ul class="simple">
<li><p>started from a batch file after Revit Batch Processor is finished</p></li>
<li><p>started as a post - process script in the Revit Batch Processor UI</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="Flows.Post_AutoFiling.output">
<span class="sig-name descname"><span class="pre">output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Flows.Post_AutoFiling.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Output messages either to batch processor (debug = False) or console (debug = True)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> (<em>str</em><em>, </em><em>optional</em>) – the message, defaults to ‘’</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Flows.Post_AutoFiling.create_target_directory">
<span class="sig-name descname"><span class="pre">create_target_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Flows.Post_AutoFiling.create_target_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up dated model incoming folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_location</strong> (<em>str</em>) – Directory in which to create a new folder</p></li>
<li><p><strong>directory_name</strong> (<em>str</em>) – New folder name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if folder was created successfully, otherwise False</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Flows.Post_AutoFiling.move_files">
<span class="sig-name descname"><span class="pre">move_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Flows.Post_AutoFiling.move_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Move files into incoming folder(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_data</strong> (<em>_type_</em>) – _description_</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if all files where moved successfully, otherwise False.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Flows.Post_AutoFiling.save_files_received_list">
<span class="sig-name descname"><span class="pre">save_files_received_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Flows.Post_AutoFiling.save_files_received_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves out a file where each row contains the dates a file was received last.</p>
<p>Note:
This reads the previously written received file and only overwrites the date of files a match was found for/</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if everything went well, otherwise False.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-Flows.Post_CombineReports">
<span id="flows-post-combinereports-module"></span><h2>Flows.Post_CombineReports module<a class="headerlink" href="#module-Flows.Post_CombineReports" title="Permalink to this heading">¶</a></h2>
<section id="combines-reports">
<h3>Combines reports.<a class="headerlink" href="#combines-reports" title="Permalink to this heading">¶</a></h3>
<p>This flow demonstrates how to combine multiple report files written per Revit project file into a single file per report type.</p>
<p>This script can be used when:</p>
<ul>
<li><p>multiple sessions of Revit Batch Processor are to be run in parallel using a batch script set up</p></li>
<li><p>single session of Revit Batch Processor is used</p></li>
<li><p>this can either be:</p>
<blockquote>
<div><ul class="simple">
<li><p>started from a batch file after Revit Batch Processor is finished</p></li>
<li><p>started as a post - process script in the Revit Batch Processor UI</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="Flows.Post_CombineReports.output">
<span class="sig-name descname"><span class="pre">output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Flows.Post_CombineReports.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Output messages either to batch processor (debug = False) or console (debug = True)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> (<em>str</em><em>, </em><em>optional</em>) – the message, defaults to ‘’</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-Flows.Pre_BuildFileList">
<span id="flows-pre-buildfilelist-module"></span><h2>Flows.Pre_BuildFileList module<a class="headerlink" href="#module-Flows.Pre_BuildFileList" title="Permalink to this heading">¶</a></h2>
<section id="write-files-to-task-lists">
<h3>Write files to task lists.<a class="headerlink" href="#write-files-to-task-lists" title="Permalink to this heading">¶</a></h3>
<p>This flow demonstrates how to write files in a given directory to an arbitrary number of task lists for Revit Batch Processor.</p>
<p>Note:</p>
<p>This code below will:</p>
<ul class="simple">
<li><p>filter files in a given directory by their file extension</p></li>
<li><p>add them to task lists depending on their file size in an attempt to create an equal workload for all Revit Batch Processor sessions to be spun up.</p></li>
</ul>
<p>This script can be used when:</p>
<ul>
<li><p>multiple sessions of Revit Batch Processor are to be run in parallel using a batch script set up and</p></li>
<li><p>the number and / or names of files to processed are likely to change.</p></li>
<li><p>this can either be:</p>
<blockquote>
<div><ul class="simple">
<li><p>started from a batch file before Revit Batch Processor is started</p></li>
<li><p>started as a pre - process script in the first session of Revit Batch Processor</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="Flows.Pre_BuildFileList.output">
<span class="sig-name descname"><span class="pre">output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Flows.Pre_BuildFileList.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Output messages either to batch processor (debug = False) or console (debug = True)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>message</strong> (<em>str</em><em>, </em><em>optional</em>) – the message, defaults to ‘’</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="flows-reportgridslevels-module">
<h2>Flows.ReportGridsLevels module<a class="headerlink" href="#flows-reportgridslevels-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-reportlinks-module">
<h2>Flows.ReportLinks module<a class="headerlink" href="#flows-reportlinks-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-reportmatts-module">
<h2>Flows.ReportMatts module<a class="headerlink" href="#flows-reportmatts-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-reportsharedparameters-module">
<h2>Flows.ReportSharedParameters module<a class="headerlink" href="#flows-reportsharedparameters-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-reportwallsdetails-module">
<h2>Flows.ReportWallsDetails module<a class="headerlink" href="#flows-reportwallsdetails-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="flows-reportworksets-module">
<h2>Flows.ReportWorksets module<a class="headerlink" href="#flows-reportworksets-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-Flows">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-Flows" title="Permalink to this heading">¶</a></h2>
</section>
</section>


          </div> 
        </div>
      </div>
    <div class="footer">
    <p>
      &copy; Copyright 2023, Jan Christel.
      Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.3.0 <a href="https://github.com/mga-sphinx/sphinx_adc_theme">ADC Theme</a> .
    (Revision )
        </p>
    </div>
      <div class="clearer"></div>
    </div>
        <div id="breadcrumbs">
                Flows package
        </div>
        <script type="text/javascript" charset="utf-8" src="../_static/js/toc.js"></script>
  </body>
</html>