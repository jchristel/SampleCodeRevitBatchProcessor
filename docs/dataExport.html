<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Export data samples. &#8212; Sample Code Revit Batch Processor 1.0.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/adctheme.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <meta name="generator" content="Sphinx/ADC Theme by Mirounga www.mirounga.fr"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Sample Code Revit Batch Processor 1.0.7 documentation" href="index.html" />
    <link rel="next" title="Misc modules and classes" href="misc.html" />
    <link rel="prev" title="Model Health Reporting." href="ModelHealth.html" />
    <link media="only screen and (max-device-width: 480px)" href="_static/css/mobile.css" type="text/css" rel="stylesheet" /> 
  </head><body>
<div id="docstitle">
    <p>Sample Code Revit Batch Processor 1.0.7 documentation</p>
</div>
<div id="header">
    <div id="title"><h1>Export data samples.</h1></div>
    <ul id="headerButtons">
        <li id="toc_button"><div class="headerButton"><a href="#">Table of Contents</a></div></li>
        <li id="page_buttons">
            <div class="headerButton"><a href="genindex.html" title="General Index" accesskey="I">index</a></div>
            <div class="headerButton"><a href="py-modindex.html" title="Python Module Index" >modules</a></div>
            <div class="headerButton"><a href="misc.html" title="Misc modules and classes" accesskey="N">next</a></div>
            <div class="headerButton"><a href="ModelHealth.html" title="Model Health Reporting." accesskey="P">previous</a></div>
        </li>
    </ul>
</div>

<div id="sphinxsidebar">
  <div class="sphinxsidebarwrapper">
        <ul><li class="toctree-l1"><a href="index.html">Main Page</a></li></ul>
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="fileSelectUI.html">Revit Batch Processor - File Selection User Interface.</a></li>
<li class="toctree-l1"><a class="reference internal" href="revitAPISampleCode.html">Revit API sample code.</a></li>
<li class="toctree-l1"><a class="reference internal" href="familyReporting.html">Revit API family property reporting.</a></li>
<li class="toctree-l1"><a class="reference internal" href="ModelHealth.html">Model Health Reporting.</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Export data samples.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#utility-functions-converting-data-retrieved-from-revit-into-shapely-geometry-and-processing-it">Utility functions converting data retrieved from Revit into shapely geometry and processing it.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#utility-functions-writing-revit-geometry-data-to-file">Utility functions writing revit geometry data to file.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Misc modules and classes</a></li>
</ul>

      <h3>This Page</h3>
      <ul class="this-page-menu">
        <li><a href="_sources/dataExport.rst.txt"
               rel="nofollow">Show Source</a></li>
      </ul>
    <div id="searchbox" style="display: none">
        <form class="search" action="search.html" method="get">
                        <div class="search-wrapper">
                        <input type="submit" value="" class="search-left"/>
                        <input class="prettysearch" type="text" name="q" size="18" title="Enter search terms or a module, class or function name."/>
                        <span class="search-right">&nbsp;</span>
                        </div>
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('#searchbox').show(0);</script>
  </div>
</div>



    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <section id="export-data-samples">
<h1>Export data samples.<a class="headerlink" href="#export-data-samples" title="Permalink to this headline">¶</a></h1>
<p>The following modules are classes used to store varies data retrieved from Revit to be used for data processing outside of Revit.</p>
<dl class="py class">
<dt class="sig sig-object py" id="DataCeiling.DataCeiling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DataCeiling.</span></span><span class="sig-name descname"><span class="pre">DataCeiling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataCeiling.DataCeiling" title="Permalink to this definition">¶</a></dt>
<dd><p>constructor</p>
<dl class="py property">
<dt class="sig sig-object py" id="DataCeiling.DataCeiling.DataType">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DataType</span></span><a class="headerlink" href="#DataCeiling.DataCeiling.DataType" title="Permalink to this definition">¶</a></dt>
<dd><p>Property: returns the data type of this class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>‘ceiling’</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DataCeiling.DataCeiling.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DataCeiling.DataCeiling.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the instance of this class to json.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A Json object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>json</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DataDesignSetOption.DataDesignSetOption">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DataDesignSetOption.</span></span><span class="sig-name descname"><span class="pre">DataDesignSetOption</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataDesignSetOption.DataDesignSetOption" title="Permalink to this definition">¶</a></dt>
<dd><p>Class constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>j</strong> (<em>dict</em><em>, </em><em>optional</em>) – A json formatted dictionary of this class, defaults to {}</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DataDesignSetOption.DataDesignSetOption.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DataDesignSetOption.DataDesignSetOption.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the instance of this class to json.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A Json object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>json</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DataGeometry.DataGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DataGeometry.</span></span><span class="sig-name descname"><span class="pre">DataGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataGeometry.DataGeometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Class constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>j</strong> (<em>dict</em><em>, </em><em>optional</em>) – json formatted dictionary of this class, defaults to {}</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DataGeometry.DataGeometry.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DataGeometry.DataGeometry.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the instance of this class to json.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A Json object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>json</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DataReadFromFile.ReadDataFromFile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DataReadFromFile.</span></span><span class="sig-name descname"><span class="pre">ReadDataFromFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filePath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataReadFromFile.ReadDataFromFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filePath</strong> (<em>str</em>) – Fully qualified file path to json formatted data file.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DataReadFromFile.ReadDataFromFile.load_Data">
<span class="sig-name descname"><span class="pre">load_Data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DataReadFromFile.ReadDataFromFile.load_Data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load json formatted rows into data objects and stores them in this class.</p>
<p>In the moment the following data objects are supported:</p>
<ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>.DataRoom</cite></p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">class</dt>
<dd class="field-odd"><p><cite>.DataCeiling</cite></p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DataReadFromFile.ReadDataFromFile.get_data_by_level">
<span class="sig-name descname"><span class="pre">get_data_by_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">levelName</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataReadFromFile.ReadDataFromFile.get_data_by_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all data objects where level name equals past in value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>levelName</strong> (<em>str</em>) – The building level name.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of room and ceiling data objects</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list [data objects]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DataReadFromFile.ReadDataFromFile.get_data_by_level_and_dataType">
<span class="sig-name descname"><span class="pre">get_data_by_level_and_dataType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">levelName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataReadFromFile.ReadDataFromFile.get_data_by_level_and_dataType" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all data objects where level name and data type equal past in values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>levelName</strong> (<em>str</em>) – The building level name.</p></li>
<li><p><strong>dataType</strong> (<em>str</em>) – A string describing the data type            refer to property .dataType on data object class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of data objects</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list [data objects]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DataRoom.DataRoom">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DataRoom.</span></span><span class="sig-name descname"><span class="pre">DataRoom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataRoom.DataRoom" title="Permalink to this definition">¶</a></dt>
<dd><p>Class constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>j</strong> (<em>dict</em><em>, </em><em>optional</em>) – A json formatted dictionary of this class, defaults to {}</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="DataRoom.DataRoom.to_json">
<span class="sig-name descname"><span class="pre">to_json</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DataRoom.DataRoom.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the instance of this class to json.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A Json object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>json</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-DataShapely"></span><section id="utility-functions-converting-data-retrieved-from-revit-into-shapely-geometry-and-processing-it">
<h2>Utility functions converting data retrieved from Revit into shapely geometry and processing it.<a class="headerlink" href="#utility-functions-converting-data-retrieved-from-revit-into-shapely-geometry-and-processing-it" title="Permalink to this headline">¶</a></h2>
<p>This module requires python &gt;3.9 due to dependencies:</p>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>shapely</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.GetTranslationMatrix">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">GetTranslationMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geoObject</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.GetTranslationMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the rotation/ translation matrix from the geometry object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>geoObject</strong> (<a class="reference internal" href="#DataGeometry.DataGeometry" title="DataGeometry.DataGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataGeometry</span></code></a>) – A data geometry object instance.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A translation matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.GetOuterLoopAsShape">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">GetOuterLoopAsShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geoObject</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translationM</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.GetOuterLoopAsShape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the boundary loop of an object as list of shapely points.</p>
<p>Points are translated with passed in matrix.
Any loops containing less then 3 points will be ignored. (Empty list will be returned)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geoObject</strong> (<a class="reference internal" href="#DataGeometry.DataGeometry" title="DataGeometry.DataGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataGeometry</span></code></a>) – A data geometry object instance.</p></li>
<li><p><strong>translationM</strong> (<em>numpy array</em>) – A translation matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of shapely points defining a polygon. (Empty list will be returned if less then 3 points in loop.)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[shapely.point]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.GetInnerLoopsAsShape">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">GetInnerLoopsAsShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geoObject</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translationM</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.GetInnerLoopsAsShape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the inner loops (holes) of an object as list of lists of shapely points.</p>
<p>Points are translated with passed in matrix.
Any inner loops containing less then 3 points will be ignored. (Empty list will be returned)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geoObject</strong> (<a class="reference internal" href="#DataGeometry.DataGeometry" title="DataGeometry.DataGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataGeometry</span></code></a>) – A data geometry object instance.</p></li>
<li><p><strong>translationM</strong> (<em>numpy array</em>) – A translation matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of lists of shapely points defining a polygon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list [list[shapely.point]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.buildShapelyPolygon">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">buildShapelyPolygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shapeS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.buildShapelyPolygon" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates shapely polygons from list of polygons past in.</p>
<p>Assumptions is first polygon describes the boundary loop and any subsequent polygons are describing         holes within the boundary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shapeS</strong> (<em>list</em><em>[</em><em>shapely.polygon</em><em>]</em>) – list of shapely polygons</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A shapely polygon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>shapely.polygon</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.GetShapelyPolygonsFromDataInstance">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">GetShapelyPolygonsFromDataInstance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataInstance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.GetShapelyPolygonsFromDataInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of of shapely polygons from data instances past in.</p>
<p>Polygons may contain holes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataInstance</strong> (A class with .geometry property returning a <a class="reference internal" href="#DataGeometry.DataGeometry" title="DataGeometry.DataGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataGeometry</span></code></a> instance.) – _description_</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of shapely polygons.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list [shapely.polygon]</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="DataShapely.geometryConverter_">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">geometryConverter_</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'ceiling':</span> <span class="pre">&lt;function</span> <span class="pre">GetShapelyPolygonsFromDataInstance&gt;,</span> <span class="pre">'room':</span> <span class="pre">&lt;function</span> <span class="pre">GetShapelyPolygonsFromDataInstance&gt;}</span></em><a class="headerlink" href="#DataShapely.geometryConverter_" title="Permalink to this definition">¶</a></dt>
<dd><p>List of available geometry (from revit to shapely ) converters</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.ReadData">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">ReadData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filePath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.ReadData" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads text files into data objects within data reader class which is returned</p>
<p>Data file to be json formatted. (one json entry per row)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filePath</strong> (<em>str</em>) – Fully qualified path to json formatted data file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A file data reader instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#DataReadFromFile.ReadDataFromFile" title="DataReadFromFile.ReadDataFromFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReadDataFromFile</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.writeReportData">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">writeReportData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fileName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writeType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.writeReportData" title="Permalink to this definition">¶</a></dt>
<dd><p>Method writing out report information to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fileName</strong> (<em>str</em>) – Fully qualified file path to data file.</p></li>
<li><p><strong>header</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of column headers, provide empty list if not required!</p></li>
<li><p><strong>data</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em>) – List of list of strings representing row data</p></li>
<li><p><strong>writeType</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘w’ new file, ‘a’ append to existing file., defaults to ‘w’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.BuildDictionaryByLevelAndDataType">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">BuildDictionaryByLevelAndDataType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataReader</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.BuildDictionaryByLevelAndDataType" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary where:</p>
<ul class="simple">
<li><p>key: is the level name</p></li>
<li><p>values is a list of list of data objects</p></li>
<li><p>first list room data objects</p></li>
<li><p>second list ceilings data objects</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataReader</strong> (<a class="reference internal" href="#DataReadFromFile.ReadDataFromFile" title="DataReadFromFile.ReadDataFromFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReadDataFromFile</span></code></a>) – A data reader class instance</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary where key is the level name, value is a list of lists of data objects.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dic{str:[[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataRoom],[:class:</span></code>.DataCeiling`]]}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.GetShapelyPolygonsFromGeoObject">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">GetShapelyPolygonsFromGeoObject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geoObjects</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.GetShapelyPolygonsFromGeoObject" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts polygon points from DataGeometry instances to shapely polygon instances and returns them as a dictionary where:</p>
<ul class="simple">
<li><p>key is the geometry objects id</p></li>
<li><p>value is a list of shapely polygons</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geoObjects</strong> (<em>list</em><em>[</em><em>data object</em><em>]</em>) – A list of instances of the the same type (i.e DataRoom)</p></li>
<li><p><strong>dataType</strong> (<em>str</em>) – _string human readable identifying the data type ( each Data… class has this as a static field: dr.DataRoom.dataType)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>{int:[shapely.polygon]}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.SortMultipleDataRows">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">SortMultipleDataRows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">associatedDataRows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">roomData</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.SortMultipleDataRows" title="Permalink to this definition">¶</a></dt>
<dd><p>Collapses multiple ceilings of one type into one with multiple ids.</p>
<p>Note: Works for ceilings only in the moment.
This is to avoid situations where one type of ceiling is briefed in a room, but in the model, multiple instances of another type are modelled.
In this case multiple type mismatches would be reported where we want only one type mismatch to be reported.
Takes into account design set / design options and offset from level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>associatedDataRows</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em>) – List of list of strings representing ceiling data</p></li>
<li><p><strong>roomData</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of string representing room data for a single room</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of list of strings representing room data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List of list [str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.GetReportData">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">GetReportData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dicObject</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.GetReportData" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a dictionary of DataRoom objects by level into list of lists of data entries per room so it can be written to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dicObject</strong> ({str:[:class: <cite>.DataRoom</cite>]}) – A dictionary where key is the level name and values is a list of DataRoom instances.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of list of strings representing room data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list [str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataShapely.GetCeilingsByRoom">
<span class="sig-prename descclassname"><span class="pre">DataShapely.</span></span><span class="sig-name descname"><span class="pre">GetCeilingsByRoom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataSourcePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputFilePath</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataShapely.GetCeilingsByRoom" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads geometry data from json formatted text file and does an intersection check between room and ceiling polygons.</p>
<p>The result is written  to a report to provided path containing a row per room and ceiling within room.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataSourcePath</strong> (<em>str</em>) – The fully qualified file path of json formatted data file containing room and ceiling data.</p></li>
<li><p><strong>outputFilePath</strong> (<em>str</em>) – The fully qualified file path of the output report.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Result class instance.
result.status. True if:</p>
<ul class="simple">
<li><p>all levels in file had ceilings and rooms.</p></li>
<li><p>report file was written successfully,</p></li>
</ul>
<p>Otherwise False.</p>
<ul class="simple">
<li><p>result.message will confirm report was written successfully.</p></li>
<li><p>result.result empty list</p></li>
</ul>
<p>On exception:</p>
<ul class="simple">
<li><p>result.status (bool) will be False.</p></li>
<li><p>result.message will contain room name and number where exception occurred as well as ceiling id.</p></li>
<li><p>result.result will be empty</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#Result.Result" title="Result.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
<span class="target" id="module-DataExport"></span><section id="utility-functions-writing-revit-geometry-data-to-file">
<h2>Utility functions writing revit geometry data to file.<a class="headerlink" href="#utility-functions-writing-revit-geometry-data-to-file" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="DataExport.ConvertDataToListJson">
<span class="sig-prename descclassname"><span class="pre">DataExport.</span></span><span class="sig-name descname"><span class="pre">ConvertDataToListJson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataIn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataExport.ConvertDataToListJson" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts lists of data classes into a single list of list of Json string representing the data class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataIn</strong> (<em>[</em><em>data class</em><em>]</em>) – list of data class instances</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of list of Json string</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DataExport.WriteJsonDataToFile">
<span class="sig-prename descclassname"><span class="pre">DataExport.</span></span><span class="sig-name descname"><span class="pre">WriteJsonDataToFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataOutPutFileName</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DataExport.WriteJsonDataToFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Collects geometry data and writes it to a new json formatted file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc</strong> (<em>Autodesk.Revit.DB.Document</em>) – Current Revit model document.</p></li>
<li><p><strong>dataOutPutFileName</strong> (<em>str</em>) – Fully qualified file path to json data file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Result class instance.</p>
<ul class="simple">
<li><p>result.status. True if json data file was written successfully, otherwise False.</p></li>
<li><p>result.message will confirm path of json data file.</p></li>
<li><p>result.result empty list</p></li>
</ul>
<p>On exception:</p>
<ul class="simple">
<li><p>result.status (bool) will be False.</p></li>
<li><p>result.message will contain exception message.</p></li>
<li><p>result.result will be empty</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="misc.html#Result.Result" title="Result.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div> 
        </div>
      </div>
    <div class="footer">
    <p>
      &copy; Copyright 2023, Jan Christel.
      Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0 <a href="https://github.com/mga-sphinx/sphinx_adc_theme">ADC Theme</a> .
    (Revision )
        </p>
    </div>
      <div class="clearer"></div>
    </div>
        <div id="breadcrumbs">
                Export data samples.
        </div>
        <script type="text/javascript" charset="utf-8" src="_static/js/toc.js"></script>
  </body>
</html>